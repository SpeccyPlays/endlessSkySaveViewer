<!DOCTYPE html>
<html>
  <head>
    <title>SpeccyPlays Endless Sky save file viewer</title>
    <link rel="icon" type="image/x-icon" href="./public/images/favicon.png" />
    <link rel="stylesheet" type="text/css" href="./public/CSS/styles.css" />
    <script src="./scripts/DataFormatting.js"></script>
    <script src="./scripts/BuildPage.js"></script>
    <script src="./scripts/Functional.js"></script>

  </head>
  <body>
    <div class="header">
      <button onclick="openFile()">Open a file</button>
      <input
        id="inp"
        type="file"
        accept=".txt"
        style="visibility: hidden"
        onchange="readFile(event)"
      />
    </div>
    <div id="filecontents">
      <div id="pilotname"></div>
      <div id="tabs"></div>
      <div id="content"></div>
      <div id="tooltip" class="tooltip"></div>
    </div>
    <script>
      /*
          SpeccyPlays file
          Whole load took:  0.214
          Formatting data took:  0.025
          Displaying data took:  0.184
          SpeccyPlays2 file
          Whole load took:  0.383
          Formatting data took:  0.035
          Displaying data took:  0.337
      */
      function openFile() {
        document.getElementById("inp").click();
      }
      function readFile(e) {
        var file = e.target.files[0];
        if (!file) return;
        if (file.type !== "text/plain") {
          alert("Please upload a valid .txt file.");
          return;
        }
        var reader = new FileReader();

        reader.onload = function (e) {
          let wnoleLoadStart, formatStart, displayStart, wholeLoadEnd, formatEnd, displayEnd;
          wholeLoadStart = Date.now();
          console.log("file loaded");
          removedChildren();
          const data = e.target.result.split("\n");
          formatStart = Date.now();
          const output = formatData(data);
          formatEnd = Date.now();
          displayStart = Date.now();
          displayData(output);
          displayEnd = Date.now();
          document.getElementsByClassName("defaultOpen")[0].click();
          wholeLoadEnd = Date.now();
          console.log("Whole load took: ", (wholeLoadEnd - wholeLoadStart) / 1000);
          console.log("Formatting data took: ", (formatEnd - formatStart) / 1000);
          console.log("Displaying data took: ", (displayEnd - displayStart) / 1000)
        };
        reader.readAsText(file);
      }
      </script>
  </body>
</html>
