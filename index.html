<!DOCTYPE html>
<html>
  <head>
    <title>SpeccyPlays Endless Sky save file viewer</title>
    <link rel="icon" type="image/x-icon" href="./images/favicon.png" />
    <link rel="stylesheet" type="text/css" href="styles.css" />
    <!-- <script src="./javascript.js"></script> -->
  </head>
  <body>
    <div class="uploadsection">
      <form name="uploadForm" id="uploadForm" onsubmit="handleSubmit(event)">
        <label for="file">File</label>
        <input id="file" name="file" type="file" accept=".txt"/>
        <input type="submit" value="upload file" id="uploadbtn" disabled/>
        <div class="uploadmsg">
            <p class="msg" id="msg"></p>
        </div>
      </form>
    </div>
    <div class="fileoutput">
        <p class="filecontent"></p>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const uploadedFile = document.getElementById("file");
            const submitBtn = document.getElementById("uploadbtn");

            uploadedFile.addEventListener("change", handleFile);

            function handleFile() {
                let msg = "";
                const file = this.files[0];

                if (!file) {
                    msg = "No files selected";
                    submitBtn.disabled = true;
                } else if (file.type !== "text/plain" || !file.name.endsWith(".txt")) {
                    msg = "Invalid file type";
                    submitBtn.disabled = true;
                } else {
                    msg = "File ready to upload";
                    submitBtn.disabled = false;
                }

                document.getElementById("msg").textContent = msg;
            }

            window.handleSubmit = function(event) {
                const file = uploadedFile.files[0];
                if (!file || file.type !== "text/plain" || !file.name.endsWith(".txt")) {
                    event.preventDefault();
                    alert("Please select a valid .txt file before submitting.");
                } else {
                    const msg = "File uploaded successfully";
                    document.getElementById("msg").textContent = msg;
                }
            }
        });
    </script>
  </body>
</html>